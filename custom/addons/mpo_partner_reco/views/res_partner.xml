<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="l10n_mx_edi_inh_res_partner_form" model="ir.ui.view">
        <field name="name">view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx_edi_extended.l10n_mx_edi_inh_res_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='l10n_mx_edi_curp']" position="attributes">
                <attribute name="attrs">{'required': [('company_type', '=', 'company'),('type_company', '=', 'fisica')]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="l10n_mx_edi_carta_porte_inh" model="ir.ui.view">
        <field name="name">view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx_edi_carta_porte.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='l10n_mx_edi_colony_code']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
        </field>
    </record>

    <record id="l10n_mx_edi_external_trade_inh" model="ir.ui.view">
        <field name="name">view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx_edi_extended_40.l10n_mx_edi_inh_res_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='l10n_mx_edi_external_trade_type']" position="after">
                <field name="l10n_mx_edi_colony_code" />
            </xpath>
        </field>
    </record>

    <record id="mx_partner_address_form" model="ir.ui.view">
        <field name="name">view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx_edi_extended.mx_partner_address_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='street_name']" position="before">
                <field name="is_supplier" invisible="1"/>
                <field name="is_client" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='street_name']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='street_number']" position="attributes">
                <attribute name="attrs">{'required' : ['|', ('is_supplier', '=', True), ('is_client', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='street_number2']" position="attributes">
                <attribute name="attrs">{'required' : ['|', ('is_supplier', '=', True), ('is_client', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='zip']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='state_id']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='l10n_mx_edi_colony']" position="attributes">
                <attribute name="attrs">{'required' : ['|', ('is_supplier', '=', True), ('is_client', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='l10n_mx_edi_colony_code']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
            <xpath expr="//field[@name='country_id']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>
            <xpath expr="//field[@name='l10n_mx_edi_locality_id']" position="attributes">
                <attribute name="attrs">{'required' : ['|', ('is_supplier', '=', True), ('is_client', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='city_id']" position="attributes">
                <attribute name="attrs">{'required' : [('country_enforce_cities', '=', True), '|', ('is_supplier', '=', True), ('is_client', '=', True)], 'invisible': [('country_enforce_cities', '=', False)], 'readonly': [('type', '=', 'contact'), ('parent_id', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='city']" position="attributes">
                <attribute name="attrs">{'required' : [('country_enforce_cities', '=', False), ('city_id', '=', False), '|', ('is_supplier', '=', True), ('is_client', '=', True)], 'invisible': [('country_enforce_cities', '=', True), '|', ('city_id', '!=', False), ('city', 'in', ['',False])], 'readonly': [('type', '=', 'contact'), ('parent_id', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='street']" position="before">
                <div name="partner_address_country" class="d-flex justify-content-between">
                    <field name="country_id" placeholder="Country" class="o_address_country"
                        options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"
                        attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)], 'required' : ['|', ('is_supplier', '=', True), ('is_client', '=', True)]}"/>
                </div>
            </xpath>
        </field>
    </record>

    <record id="view_partner_form" model="ir.ui.view">
        <field name="name">view.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='vat']" position="after">
                <field name="is_supplier"/>
                <field name="is_client"/>
            </xpath>
            <xpath expr="//span[@name='address_name']" position="before">
                <field name="firstname" attrs="{'invisible': [('company_type', '=', 'company')], 'required': [('company_type', '=', 'person')]}"/>
                <field name="lastname" attrs="{'invisible': [('company_type', '=', 'company')], 'required': [('company_type', '=', 'person')]}"/>
                <field name="surname" attrs="{'invisible': [('company_type', '=', 'company')], 'required': [('company_type', '=', 'person')]}"/>
            </xpath>
            <xpath expr="//field[@id='company']" position="attributes">
                <attribute name="attrs">{'required' : ['|', '|', ('is_supplier', '=', True), ('is_client', '=', True), '&amp;', ('type', '=', 'contact'), ('is_company', '=', True)], 'invisible': [('is_company','=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@id='individual']" position="attributes">
                <attribute name="attrs">{'required' : [('type', '=', 'contact'), ('is_company', '=', False)], 'invisible': [('is_company','=', True)]}</attribute>
                <attribute name="force_save">True</attribute>
            </xpath>
            <xpath expr="//field[@name='vat']" position="attributes">
                <attribute name="attrs">{'readonly': [('parent_id','!=',False)], 'required': [('parent_id','=',False)]}</attribute>
            </xpath>
            <!-- <xpath expr="//field[@name='name']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='phone']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath> -->
            <xpath expr="//field[@name='company_type']" position="after">
                <div>
                    <field name="type_company" widget="radio" options="{'horizontal': true}" attrs="{'invisible': [('company_type', '!=', 'company')]}"/>
                </div>
            </xpath>
            <xpath expr="//field[@id='individual']" position="after">
                <field name="commercial_name" placeholder="Nombre Comercial" attrs="{'invisible': ['|',('company_type', '!=', 'company'),('type_company', '!=', 'moral')], 'required': [('company_type', '=', 'company'),('type_company', '=', 'moral')]}"/>
            </xpath>
            <xpath expr="//notebook/page[last()]" position="after">
                <page name="legal_partner_info" string="Representante Legal">
                    <field name="legal_partners_ids" nolabel="1">
                        <tree editable="bottom">
                            <field name="name" />
                            <field name="legal_partner_rfc" />
                            <field name="legal_partner_curp" />
                            <field name="legal_partner_default" />
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <record id="l10n_mx_edi_inh_40_res_partner_form" model="ir.ui.view">
        <field name="name">res.partner.form40.inherit.l10n_mx_edi</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx_edi_40.l10n_mx_edi_inh_40_res_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='l10n_mx_edi_fiscal_regime']" position="attributes">
                <attribute name="attrs">{'invisible': [('country_code', 'not in', ['MX', False])], 'required' : [('country_code', '=', 'MX'), '|', ('is_supplier', '=', True), ('is_client', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>
    <record id="res_partner_view_form_inherit_mail" model="ir.ui.view">
        <field name="name">res.partner.view.form.inherit.mail</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="mail.res_partner_view_form_inherit_mail"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='email']" position="attributes">
                <attribute name="attrs">{'required': ['|', '|', ('is_supplier', '=', True), ('is_client', '=', True), ('user_ids','!=', [])]}</attribute>
            </xpath>
        </field>
    </record>
    <record model="ir.ui.view" id="view_res_partner_inherit_l10n_mx_edi_bank">
        <field name="name">view.res.partner.inherit.l10n_mx_edi_bank</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="l10n_mx.view_res_partner_inherit_l10n_mx_edi_bank"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='l10n_mx_edi_clabe']" position="attributes">
                <attribute name="attrs">{'required' : ['|', ('parent.is_supplier', '=', True), ('parent.is_client', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>
</odoo>
