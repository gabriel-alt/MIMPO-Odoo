<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <!-- Transport Request Report -->
    <template id="mimpo_load_order_template">
        <t t-call="web.basic_layout">
            <style>
                .table_mimpo {
                    padding: 1px;
                    margin-bottom: 12px;
                    font-size: 12px;
                    vertical-align: top;
                }
                .table_mimpo .td_normal {
                    padding: 1px;
                    vertical-align: top;
                }
                .table_mimpo .td_border {
                    border: 1px solid black;
                    padding: 1px;
                    vertical-align: top;
                }
                .table_mimpo .td_noborder {
                    border: 0px solid white;
                    padding: 1px;
                    vertical-align: top;
                }
                .table_mimpo .td_borderc {
                    border: 1px solid black;
                    padding: 1px;
                    vertical-align: top;
                    text-align: center;
                }
            </style>
            <div class="header" style="font-family:'Times New Roman'">
                <div class="row col-12" style="font-size: 10px;padding-bottom: 3px">
                    <div class="col-4 mb4">
                        <img t-if="doc.company_id.logo" t-att-src="image_data_uri(doc.company_id.logo)" style="max-width: 180px;" alt="Logo"/>
                    </div>
                    <div class="col-6 mb4" style="font-size: 12px;vertical-align: middle; text-align: center;">
                        <strong style="font-size: 14px;"><u><span t-field="doc.company_id"/></u></strong><br/>
                        <strong t-esc="doc.company_id.partner_id._display_address(without_company=True)"/><br/>
                        <t t-if="doc.company_id.phone"><strong t-field="doc.company_id.phone"/> </t>
                        <t t-if="doc.company_id.vat"><strong>R.F.C <span t-field="doc.company_id.vat"/></strong></t>
                    </div>
                    <div class="col-2 mb4" style="font-size: 12px;vertical-align: middle; text-align: right;">
                        <span>ORDEN#:</span><br/>
                        <strong t-field="doc.name"/><br/>
                        <span>FOLIO SISTEMA:</span><br/>
                        <strong t-field="doc.folio"/>
                    </div>
                </div>
            </div>
            <div class="page" style="font-family:'Times New Roman'">
                <div class="row">
                <table class="table_mimpo table-borderless" name="bill_to" width="100%">
                    <tr t-if="with_amount">
                        <td colspan="3" class="td_noborder">
                            FACTURAR A: <strong t-field="doc.company_bill_id"/>
                        </td>
                    </tr>
                    <tr>
                        <td width="11%" class="td_noborder">ORIGEN:</td>
                        <td width="39%" class="td_noborder">
                            <strong t-field="doc.company_shipper_id"/></td>
                        <td width="50%" class="td_noborder">
                            DESTINO: <strong t-field="doc.company_deliver_id"/></td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            REMITENTE: <strong t-esc="doc.company_shipper_id._display_address(without_company=True)"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            DESTINATARIO: <strong t-field="doc.company_deliver_contact_id"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            SE ENTREGA EN: <strong t-esc="doc.company_deliver_id._display_address(without_company=True)"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            NOMBRE CONTACTO: <strong t-field="doc.company_deliver_contact_id.name"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            TELEFONO CONTACTO: <strong t-field="doc.company_deliver_contact_id.phone"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" class="td_noborder">
                            REFERENCIA: <strong t-if="doc.sir_request_ids" t-esc="', '.join(map(lambda x: (x.number), doc.sir_request_ids))" id="sir_request"/>
                        </td>
                    </tr>
                </table>
                </div>
                <div class="row mt-2" t-if="not with_amount">
                <table class="table_mimpo table-borderless" name="bill_to" width="100%">
                    <tr>
                        <td width="50%" class="td_noborder" style="vertical-align: top;">
                            <span>NOMBRE TRANSPORTE: </span><strong t-field="doc.nombre_transpor"/>
                            <br/><span>TIPO UNIDAD: </span><strong t-field="doc.transport_request_line_id.tarif_element_id.route_id.unit_type_id"/>
                        </td>
                        <td width="50%" class="td_noborder" style="vertical-align: top; text-align: right;">
                            USUARIO CREACIÓN:<br/><strong t-field="doc.create_uid"/>
                            <br/>FECHA CREACIÓN:<br/><strong t-field="doc.create_date"/>
                        </td>
                    </tr>
                </table>
                </div>
                <div class="row mt-3" t-if="with_amount" style="font-size: 12px;">
                    <span>NOMBRE TRANSPORTE: </span><strong t-field="doc.nombre_transpor"/>
                    <br/><span>TIPO UNIDAD: </span><strong t-field="doc.transport_request_line_id.tarif_element_id.route_id.unit_type_id"/>
                    <br/><span>ECONÓMICO: </span><strong t-field="doc.transport_request_line_id.vehicle_economic"/>
                    <br/><span>PLACA: </span><strong t-field="doc.transport_request_line_id.vehicle_plates"/>
                    <br/><span>CHOFER: </span><strong t-field="doc.transport_request_line_id.vehicle_operator"/>
                </div>
                <div class="row mt-3" t-if="with_amount">
                <table class="table_mimpo table-borderless">
                    <tr>
                        <td width="30%" class="td_noborder" style="text-align: center;">CONCEPTOS</td>
                        <td width="12%" class="td_noborder" style="text-align: center;">TARIFA PROVEEDOR</td>
                        <td width="12%" class="td_noborder" style="text-align: center;">TARIFA CLIENTE</td>
                        <td width="46%" class="td_noborder" rowspan="5"></td>
                    </tr>
                    <t t-set="line_category" t-value="doc._get_concept_line_category()"/>
                    <tr>
                        <td class="td_noborder">FLETES:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['fletes']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['fletes']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">MOVIMIENTOS EN FALSO:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['movimientos']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['movimientos']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">ESTADIAS POR REMOLQUE:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['estadias']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['estadias']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">RE-EXPEDICIÓN DE DESTINO:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['reexp']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['reexp']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">LOGÍSTICA INVERSA:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['logistic']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['logistic']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" rowspan="4" style="vertical-align: top; text-align: right;">
                            USUARIO CREACIÓN:<br/><strong t-field="doc.create_uid"/><br/>
                            FECHA CREACIÓN:<br/><strong t-field="doc.create_date"/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">OTROS CARGOS:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['otros']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['otros']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <tr>
                        <td class="td_noborder">TOTAL CARGOS:</td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['vendor']['total']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                        <td class="td_noborder" style="text-align: right;"><strong t-esc="line_category['customer']['total']" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                    <t t-set="total_diff" t-value="line_category['customer']['total'] - line_category['vendor']['total']"/>
                    <tr>
                        <td class="td_noborder" colspan="3" style="text-align: center;">
                            DIFERENCIA: <strong t-esc="total_diff" t-options='{"widget": "monetary", "display_currency": doc.company_id.currency_id}'/></td>
                    </tr>
                </table>
                </div>
            </div>
            <div class="footer" style="font-family:'Times New Roman';font-size: 12px;">
                <div class="row" style="background-color:blue;color:#FFFFFF">
                    <div class="col-8">
                        <span t-esc="doc._get_timenow_mex()"/>
                    </div>
                    <div class="col-3 offset-1 text-center">
                        Página <span class="page"/> de <span class="topage"/>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="report_load_order_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="lang" t-value="user.lang"/>
                <t t-call="mpo_transport_request.mimpo_load_order_template" t-lang="lang"/>
            </t>
        </t>
    </template>

    <record id="action_load_order_report" model="ir.actions.report">
        <field name="name">Load Order</field>
        <field name="model">load.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">mpo_transport_request.report_load_order_template</field>
        <field name="report_file">mpo_transport_request.report_load_order_template</field>
        <field name="print_report_name">(object._get_report_base_filename())</field>
        <field name="binding_model_id" ref="mpo_transport_request.model_load_order"/>
        <field name="paperformat_id" ref="mpo_transport_request.paperformat_transport_request_report"/>
        <field name="binding_type">report</field>
    </record>

    <template id="report_load_order_with_amount_template">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="lang" t-value="user.lang"/>
                <t t-set="with_amount" t-value="True"/>
                <t t-call="mpo_transport_request.mimpo_load_order_template" t-lang="lang"/>
            </t>
        </t>
    </template>

    <record id="action_load_order_with_amount_report" model="ir.actions.report">
        <field name="name">Load Order with Amount</field>
        <field name="model">load.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">mpo_transport_request.report_load_order_with_amount_template</field>
        <field name="report_file">mpo_transport_request.report_load_order_with_amount_template</field>
        <field name="print_report_name">(object._get_report_base_filename())</field>
        <field name="binding_model_id" ref="mpo_transport_request.model_load_order"/>
        <field name="paperformat_id" ref="mpo_transport_request.paperformat_transport_request_report"/>
        <field name="binding_type">report</field>
    </record>
</odoo>