<odoo>

	<record id="view_move_form" model="ir.ui.view">
		<field name="name">view_move_form.mpo_cga_generation</field>
		<field name="model">account.move</field>
		<field name="inherit_id" ref="mpo_sir.view_move_form"/>
		<field name="arch" type="xml">
			<xpath expr="//header/button[@name='button_set_checked']" position="after">
				<button name="action_link_expense" string="Link Expense" class="oe_highlight" type="object" groups="account.group_account_invoice" attrs="{'invisible': ['|', ('state', '=', 'cancel'), ('move_type', '!=', 'out_invoice')]}"/>
			</xpath>

			<xpath expr="//field[@name='line_ids']/tree/field[@name='partner_id']" position="after">
				<field name="cga_line" readonly="1" optional="hide"/>
			</xpath>

			<xpath expr="//notebook" position="inside">
				<page string="Expenses Incurred by the Client" name="partner_expense" attrs="{'invisible': [('move_type', 'not in', ['out_invoice', 'out_refund'])]}">
					<field name="partner_expense_line_ids"
							attrs="{'readonly': [('state', '!=', 'draft')]}"
							widget="many2many"
							domain="[('sir_id', '=', sir_id), ('move_id.move_type', '=', 'in_invoice')]">
						<tree create="false" editable="bottom">
							<field name="move_id" readonly="1" optional="show"/>
							<field name="partner_id" readonly="1" optional="hide"/>
							<field name="invoice_date" readonly="1" optional="hide"/>
							<field name="to_agency" readonly="1" widget="boolean_toggle" optional="show"/>
							<field name="currency_id" invisible="1"/>
							<field name="company_currency_id" invisible="1"/>
							<field name="expense_move_currency_id" invisible="1"/>
							<field name="exchange_rate" optional="hide" />
                            <!-- <field name="total_expense" readonly="1" optional="show"/> -->
							<field name="subtotal_expense_currency" readonly="1" optional="show"/>
                            <!-- <field name="price_subtotal" readonly="1" optional="show"/>
							<field name="price_total" readonly="1" optional="show"/> -->
							<field name="price_unit_expense_currency" optional="show" string="Price"/>
							<field name="expense_description" optional="show" string="Description"/>
						</tree>
					</field>
					<group col="12" class="oe_invoice_lines_tab">
						<group colspan="8"></group>
						<group colspan="4">
							<group class="oe_subtotal_footer oe_right">
								<field name="total_expense_currency"/>
								<field name="trusted_fund_balance"/>
								<field name="remaining_trusted_fund_balance" string="Remaining Balance"/>
							</group>
						</group>
					</group>
				</page>
			</xpath>
			<xpath expr="//field[@name='line_ids']/tree/field[@name='amount_currency']" position="attributes">
				<attribute name="attrs">{'column_invisible': [('parent.partner_expense_line_ids', '!=', False)]}</attribute>
			</xpath>
			<xpath expr="//field[@name='line_ids']/tree/field[@name='amount_currency']" position="after">
				<field name="expense_bill_currency_id" options="{'no_create': True}" string="Currency"
					optional="hide" groups="base.group_multi_currency" readonly="1"
					attrs="{'column_invisible': [('parent.partner_expense_line_ids', '=', False)]}"/>
				<field name="expense_amount_currency" string="Importe en divisa"
					optional="hide" groups="base.group_multi_currency" readonly="1"
					attrs="{'column_invisible': [('parent.partner_expense_line_ids', '=', False)]}"/>
			</xpath>
		</field>
	</record>

    <record id="view_move_form_inherit_exclude_xml_vendor" model="ir.ui.view">
        <field name="name">account.move.form.exclude.from.xml.vendor</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="arch" type="xml">

            <xpath expr="//field[@name='to_agency']" position="after">
                <field name="exclude_from_xml" readonly="1" string="Excluido del XML"
                    attrs="{'invisible': [('move_type', '!=', 'in_invoice')]}" />
            </xpath>

        </field>
    </record>


</odoo>
